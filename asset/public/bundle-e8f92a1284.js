function ready(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}!function(e,t,n){var i=0;function o(e){return e.firstChild.dataset.identifier}function l(){for(;this._container.firstChild;)this._container.removeChild(this._container.firstChild)}function r(e){null!=e&&(e.className=e.className.split(" ").filter(e=>!/ac__word--selected/.test(e)).join(" "))}e.Autocomplete=function(){i++;let e=this;e._id=i,e._input,e._idx,e._words,e._container,e._onSelectedCB=(()=>{}),e._config={delay:150,showWords:!0,hideOnblur:!0};let n=arguments[0];n&&"string"==typeof n?e._config.selector=n:n&&"object"==typeof n&&Object.keys(n).forEach(t=>{e._config[t]=n[t]}),e._words=[],e._idx=-1,e._keyListenerDebounced=function(e,t){let n=!0;return function(){n&&(n=!1,setTimeout(()=>{e.apply(null,Array.prototype.slice.apply(arguments)),n=!0},t))}}(function(e){var n=this,i=new XMLHttpRequest,o=t.querySelector("#search-form").dataset.url;i.open("GET",o+"?query="+e,!0),i.onreadystatechange=function(){if(4==i.readyState){var e={};if(i.responseText&&(e=JSON.parse(i.responseText)),200==this.status&&n._config.showWords){if(0==e.results.length)return;(function(e){l.call(this),this._words=[];let n=t.createDocumentFragment();for(let i=0;i<e.length;i++){let o=t.createElement("p");o.className="ac__word",o.style.cursor="pointer";let l=t.createElement("span");l.style.pointerEvents="none",l.dataset.identifier=e[i].url,highlighted=e[i].text,highlighted=highlighted.trim(),l.innerHTML=highlighted,o.appendChild(l),n.appendChild(o),this._words.push(o)}this._container.appendChild(n)}).call(n,e.results)}}},i.send(null)}.bind(e),e._config.delay),e._input=t.querySelector(e._config.selector),null!=e._input&&(e._input.setAttribute("autocomplete","off"),e._config.showWords?(e._input.addEventListener("keyup",function(e){let t=e.keyCode||e.which,n=String.fromCharCode(t),i=this;if(38===t)i._idx>0&&(r(i._words[i._idx]),i._idx--),i._words[i._idx].className+=" ac__word--selected";else if(40==t)i._idx<i._words.length-1&&(r(i._words[i._idx]),i._idx++),i._words[i._idx].className+=" ac__word--selected";else if(13==t)i._words.length&&i._idx>-1?i._onSelectedCB(o(i._words[i._idx])):i._onSelectedCB(i._input.value);else if(/[a-zA-Z0-9-_ ]/.test(n)||8===t){i._idx=-1;let e=encodeURIComponent(i._input.value);""!=e?i._keyListenerDebounced(e):l.call(i)}}.bind(e),!1),function(){let e=t.createElement("div");e.className="ac__container",e.style.width=this._input.offsetWidth,this._input.parentNode.insertBefore(e,this._input.nextSibling);let n=t.createElement("div");n.className="ac__inner",n.style.position="absolute",n.style.top="100%",n.style.left=0,n.style.width="100%",e.appendChild(n),this._container=n}.call(e),function(){this._container.addEventListener("click",e=>{e.target!==e.currentTarget&&this._onSelectedCB(o(e.target)),e.stopPropagation()})}.call(e)):e._input.addEventListener("keyup",function(e){let t=e.keyCode||e.which,n=String.fromCharCode(t);if(13==t)this._onSelectedCB(this._input.value);else if(/[a-zA-Z0-9-_ ]/.test(n)||8===t){let e=encodeURIComponent(this._input.value);""!=e&&this._keyListenerDebounced(e)}}.bind(e),!1)),e._config.hideOnblur&&e._container.parentNode.classList.add("ac__container--hide-on-blur"),e._input.addEventListener("click",t=>{e._container.parentNode.style.display="block",t.AutocompleteClicked=!0})},e.addEventListener("load",function(){t.body.addEventListener("click",e=>{if(!e.AutocompleteClicked){let e=t.querySelectorAll(".ac__container--hide-on-blur");Array.prototype.slice.call(e).forEach(e=>e.style.display="none")}})}),Autocomplete.prototype.onSelectedWord=function(e){this._onSelectedCB=e},Autocomplete.prototype.onNewWords=function(e){this._onWordsCB=e}}(window,document),ready(function(){new Autocomplete({selector:".search-text",delay:200}).onSelectedWord(function(e){window.location.href=e})});